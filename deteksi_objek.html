<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplikasi Deteksi Objek TensorFlow.js</title>
    
    <style>
        /* Gaya Sederhana untuk Tata Letak */
        body {
            font-family: sans-serif;
            margin: 20px;
            text-align: center;
            background-color: #f4f4f9;
        }
        h1 {
            color: #333;
        }
        #container {
            position: relative;
            margin: 20px auto;
            width: fit-content;
            border: 2px solid #ccc;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        video, canvas {
            display: block;
        }
        /* Video akan menampilkan input webcam */
        #videoElement {
            transform: scaleX(-1); /* Membalik video agar terasa seperti cermin */
            width: 640px;
            height: 480px;
            background-color: #000;
        }
        /* Canvas akan menimpa video untuk menampilkan bounding box */
        #canvasElement {
            position: absolute;
            top: 0;
            left: 0;
        }
        #status {
            margin-top: 15px;
            padding: 10px;
            background-color: #e0f7fa;
            border-radius: 5px;
            color: #00796b;
        }
    </style>
</head>
<body>

    <header>
        <h1>Aplikasi Deteksi Objek</h1>
        <p>Menggunakan **TensorFlow.js** untuk deteksi objek real-time.</p>
    </header>

    <div id="container">
        <video id="videoElement" autoplay playsinline muted></video>
        
        <canvas id="canvasElement"></canvas>
    </div>

    <div id="status">Status: Menunggu inisialisasi model...</div>

    <footer>
        <p>&copy; 2024 Demo Aplikasi Deteksi Objek</p>
    </footer>

    <script>
        // --- Bagian JavaScript (Placeholder Logika Deteksi) ---
        
        const video = document.getElementById('videoElement');
        const canvas = document.getElementById('canvasElement');
        const statusDiv = document.getElementById('status');
        const context = canvas.getContext('2d');
        
        // 1. Dapatkan Akses ke Webcam
        async function setupWebcam() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                video.srcObject = stream;
                
                return new Promise((resolve) => {
                    video.onloadedmetadata = () => {
                        // Atur ukuran canvas agar sesuai dengan video
                        canvas.width = video.videoWidth;
                        canvas.height = video.videoHeight;
                        resolve(true);
                    };
                });
            } catch (error) {
                statusDiv.textContent = 'ERROR: Gagal mengakses webcam. Pastikan Anda memberikan izin.';
                console.error(error);
            }
        }

        // 2. Placeholder untuk Inisialisasi Model TensorFlow.js
        async function loadModel() {
            statusDiv.textContent = 'Memuat model TensorFlow.js...';
            
            // Catatan: Di sini Anda akan menggunakan tf.loadGraphModel atau serupa
            // untuk memuat model COCO-SSD, MobileNet, atau model kustom Anda.
            
            // Contoh Placeholder:
            await new Promise(resolve => setTimeout(resolve, 2000)); // Simulasi pemuatan 2 detik
            statusDiv.textContent = 'Model berhasil dimuat. Siap mendeteksi.';
            
            return {
                // Objek model placeholder
                detect: async (source) => {
                    // Logika deteksi placeholder:
                    // Di sini seharusnya Anda memanggil model.execute() atau model.detect()
                    console.log('Mendeteksi objek...');
                    return []; // Mengembalikan array kosong untuk demo
                }
            };
        }

        // 3. Loop Deteksi (Main Loop)
        async function detectionLoop(model) {
            
            const predictions = await model.detect(video);
            
            // Hapus hasil sebelumnya
            context.clearRect(0, 0, canvas.width, canvas.height);
            
            // Placeholder: Gambar hasil deteksi (bounding box)
            // Di sini Anda akan mengiterasi array 'predictions' dan menggambar di canvas
            
            // Contoh menggambar kotak dummy:
            if (predictions.length === 0) {
                 context.strokeStyle = 'red';
                 context.lineWidth = 2;
                 // Gambar kotak di tengah
                 context.strokeRect(canvas.width / 4, canvas.height / 4, canvas.width / 2, canvas.height / 2);
                 context.fillStyle = 'red';
                 context.font = '24px Arial';
                 context.fillText('Objek Dummy', canvas.width / 4, canvas.height / 4 - 10);
            }
            
            // Panggil loop lagi untuk frame berikutnya
            requestAnimationFrame(() => detectionLoop(model));
        }

        // 4. Fungsi Utama
        async function main() {
            const webcamReady = await setupWebcam();
            if (webcamReady) {
                const model = await loadModel();
                video.play();
                detectionLoop(model);
            }
        }
        
        main();

    </script>
</body>
</html>
